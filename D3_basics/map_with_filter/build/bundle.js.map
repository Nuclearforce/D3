{"version":3,"file":"bundle.js","sources":["../src/scripts/loadAndProcessData.js","../src/scripts/colorLegend.js","../src/scripts/ChoroplethMap.js","../src/scripts/index.js"],"sourcesContent":["import {\n    json\n    ,tsv\n} from 'd3';\nimport { feature } from 'topojson'; \n\nexport const loadAndProcessData=()=>\nPromise.all([\n    tsv('https://unpkg.com/world-atlas@1.1.4/world/50m.tsv'),\n    json('https://unpkg.com/world-atlas@1.1.4/world/50m.json')])\n    .then(([tsvData, topojsonData])=>{\n\n    const rowById=tsvData.reduce((accumulator,d)=>{\n        accumulator[d.iso_n3]=d;\n        return accumulator;\n    },{});\n\n    const countries = feature(topojsonData,topojsonData.objects.countries);\n\n    countries.features.forEach(d=>{\n        Object.assign(d.properties, rowById[d.id]);\n    });\n\n    return countries;\n});","export const colorLegend = (selection, props) =>{\n    const {colorScale\n        ,circleRadius\n        ,spacing    \n        ,textOffset\n        ,backgroundRectWidth\n        ,onClick\n        ,selectedColorValue\n    } = props;\n    const n = colorScale.domain().length;\n    const backgroundRect = selection.selectAll('rect')\n        .data([null]);\n    backgroundRect.enter().append('rect')\n        .merge(backgroundRect)\n            .attr('x',-circleRadius*2)\n            .attr('y',-circleRadius*2)\n            .attr('rx',circleRadius*2)\n            .attr('width',backgroundRectWidth)\n            .attr('height',spacing * n + circleRadius*2)\n            .attr('fill','white')\n            .attr('opacity',0.8);\n\n    const groups = selection.selectAll('.tick')\n            .data(colorScale.domain());\n\n    const groupsEnter = groups\n        .enter().append('g')\n        .attr('class','tick');\n\n    groupsEnter.merge(groups)\n            .attr('transform',(d,i)=>\n                `translate(0,${i*spacing})`\n            )\n            .attr('opacity',d => \n                (!selectedColorValue || d === selectedColorValue)\n                ? 1\n                : 0.2\n            )\n            .on('click',d=>onClick(\n                d===selectedColorValue\n                    ? null  \n                    : d\n            ));\n    groups.exit().remove();\n    \n    groupsEnter.append('circle')\n    .merge(groups.select('circle'))\n        .attr('r',circleRadius)\n        .attr('fill',colorScale);\n\n    groupsEnter.append('text')\n    .merge(groups.select('text'))\n        .text(d=>d)\n        .attr('dy','0.32em')\n        .attr('x',textOffset);\n    }","import {geoPath\n    ,geoNaturalEarth1\n    ,zoom\n    ,event \n} from 'd3';\n\nconst projection = geoNaturalEarth1();\nconst pathGenerator = geoPath().projection(projection);\n\nexport const choroplethMap = (selection, props) =>{\n    const {features,\n        colorScale, \n        colorValue,\n        selectedColorValue\n    } = props;\n\nconst gUpdate = selection.selectAll('g').data([null]);\nconst gEnter = gUpdate.enter().append('g');\nconst g = gUpdate.merge(gEnter)\n\ngEnter\n    .append('path')\n        .attr('class','sphere')\n        .attr('d',pathGenerator({type:'Sphere'}))\n    .merge(gUpdate.select('.sphere'))\n        .attr('opacity',selectedColorValue\n            ? 0.2\n            : 1);\n\nselection.call(zoom().on('zoom',()=>{\n    g.attr('transform',event.transform);\n}));\n\nconst countryPaths = g.selectAll('.country')\n    .data(features);\nconst countryPathsEnter = countryPaths\n    .enter().append('path')\n        .attr('class','country');\n    countryPaths.merge(countryPathsEnter)\n        .attr('d', pathGenerator)\n        .attr('fill',d=>colorScale(colorValue(d)))\n        .attr('opacity',d=> (!selectedColorValue || selectedColorValue===colorValue(d))\n            ? 1\n            : 0.2)\n        .classed('highlighted',d=> selectedColorValue && selectedColorValue ===colorValue(d));\n\n    countryPathsEnter.append('title')\n        .text(d=>d.properties.name + ': ' + colorValue(d));\n\n};","import { select\n    ,scaleOrdinal\n    ,schemeSpectral\n} from 'd3';\nimport { loadAndProcessData } from './loadAndProcessData'; \nimport {colorLegend} from './colorLegend';\nimport {choroplethMap} from './ChoroplethMap.js';\n\nconst svg=select('svg');\nconst choroplethMapG = svg.append('g');\nconst colorLegendG = svg.append('g')\n    .attr('transform',`translate(30,300)`);\n\nconst colorScale =  scaleOrdinal();\nconst colorValue = d=>d.properties.income_grp;\n\nlet selectedColorValue;\nlet features;\n\nconst onClick = d=>{\n    selectedColorValue=d;\n    render();\n};\n\nloadAndProcessData().then(countries=>{\n    features=countries.features;\n    render();    \n});\n\nconst render=()=>{\n\n    colorScale\n        .domain(features.map(colorValue))\n        .domain(colorScale.domain().sort().reverse())\n        .range(schemeSpectral[colorScale.domain().length]);\n\n    colorLegendG.call(colorLegend, {\n        colorScale,\n        circleRadius:8,\n        spacing: 20,\n        textOffset:12,\n        backgroundRectWidth:235,\n        onClick,\n        selectedColorValue\n    });\n\n    choroplethMapG.call(choroplethMap, {\n        features\n        ,colorScale\n        ,colorValue\n        ,selectedColorValue\n    });\n\n};\n"],"names":["tsv","json","feature","geoNaturalEarth1","geoPath","zoom","event","select","scaleOrdinal","schemeSpectral"],"mappings":"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"}